name: Crawler Agenda Automatizado
on:
  schedule:
    - cron: '0 */2 * * *' # Se ejecuta en el minuto 0 de cada 2 horas (00:00, 02:00, 04:00, etc.)
  workflow_dispatch:      # Permite ejecutarlo manualmente desde la pestaña Actions

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout del código
        uses: actions/checkout@v3

      - name: Configurar Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'

      - name: Instalar dependencias
        run: |
          pip install requests beautifulsoup4 cloudscraper

      - name: Ejecutar Crawler
        env:
          # Aquí le decimos al script la URL de Render
          API_URL: ${{ secrets.API_URL_RENDER }}
        run: python scripts/crawler_agenda.py
